# Исправление подключения к БД

## Проблема
Подключение к БД по приватному IP `10.19.0.1` не работает (таймаут).

## Решение

### Вариант 1: Использовать публичный хост (рекомендуется)

На сервере отредактируйте `.env` файл:

```bash
cd /var/www/arteconew
nano .env
```

Замените содержимое на:

```env
# PostgreSQL Database Connection (Beget)
# Используем публичный хост, так как приватный IP недоступен
DATABASE_URL=postgresql://arteco:8926416Salavat1996s%40@jogelfilulmir.beget.app:5432/arteco_db
DATABASE_SSL=true
```

**Важно:** 
- `@` в пароле экранирован как `%40`
- Используем `DATABASE_SSL=true` для внешнего хоста

### Вариант 2: Проверить доступность приватного IP

Попробуйте проверить доступность БД:

```bash
# Проверка доступности порта
telnet 10.19.0.1 5432
# или
nc -zv 10.19.0.1 5432
```

Если не работает, используйте Вариант 1.

## После изменения .env:

1. **Проверьте подключение:**
   ```bash
   node scripts/test-db-connection.js
   ```

2. **Выполните миграцию (если еще не выполнили):**
   ```bash
   # Через публичный хост
   PGPASSWORD='8926416Salavat1996s@' psql -h jogelfilulmir.beget.app -p 5432 -U arteco -d arteco_db -f database/schema.sql
   ```

3. **Перезапустите приложение:**
   ```bash
   pm2 restart arteconew --update-env
   pm2 logs arteconew --lines 30
   ```

4. **Проверьте работу:**
   - Откройте: http://155.212.147.140:3000/admin
   - Попробуйте добавить товар

## Если все еще не работает:

1. Проверьте, что БД доступна из панели Beget
2. Убедитесь, что порт 5432 открыт в firewall Beget
3. Проверьте правильность пароля в панели Beget
